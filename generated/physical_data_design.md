# Physical Data Design for Licensing Self-Certification Portal (LSCP)

**Version 0.1**

**Jan 2025**

? The Government of the Hong Kong Special Administrative Region

## 1. Introduction

This document provides a comprehensive description of the physical data design for the Licensing Self-Certification Portal (LSCP) project. It serves as a blueprint for implementing the LSCP database, ensuring a robust and efficient data management system. This document covers the database statistics, collection overview, field analysis, and the mapping between the logical and physical data models. The chosen database system is MongoDB, complemented by Microsoft SQL Server 2019 for specific data storage needs.

## 2. Database Statistics

-   Database Size: 88.10 MB
-   Collections: 12
-   Total Documents: 1278983
-   Total Data Size: 371.24 MB

## 3. Collections Overview

| Collection Name      | Document Count | Size (MB) | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| -------------------- | -------------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| tasks                | 5523           | 0.99      | Stores tasks assigned to users, including task type, application, submission case, user, and team.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| eminutes             | 133            | 0.03      | Stores electronic minutes (e-minutes) associated with cases, including comments, content, and related IDs.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| submissions          | 0              | 0.00      | (Currently Empty) Intended to store submissions made through the portal.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| applications         | 381            | 0.36      | Stores application data, including applicant information, premise details, and assigned personnel.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| notifications        | 1837           | 0.24      | Stores notifications for users, related to tasks and e-minutes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| bsblocks             | 98397          | 6.40      | Stores building structure IDs and corresponding CA codes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| cases                | 451            | 1.17      | Stores case data, including application details, assigned personnel, and assessment information.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| oauthtokens          | 3019           | 2.29      | Stores OAuth tokens for user authentication.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| sysfilerefs          | 601808         | 204.70    | Stores system file references, linking to actual files stored elsewhere.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| attachments          | 370            | 0.13      | Stores attachments related to applications and cases, including file details and associated metadata.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| users                | 116            | 0.04      | Stores user information, including login credentials, roles, and team assignments.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| adrblkfilerefs       | 566948         | 154.89    | Stores address block file references, linking address blocks to system file references.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |

## 4. Field Analysis (Examples)

This section provides a detailed analysis of the fields within selected collections, including their data types and occurrences.

### Collection: tasks

| Field            | Types             | Occurrences | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
#### adrblkfilerefs
- Document Count: 566948
- Size: 154.89 MB
- Average Document Size: 0.28 KB

#### Field Analysis
#### __v
- Types: int
- Occurrences: 1000
----------------
#### _id
- Types: objectId
- Occurrences: 1000
----------------
#### adrBlkFileRefId
- Types: string
- Occurrences: 1000
----------------
#### adrBlkId
- Types: string
- Occurrences: 1000
----------------
#### createdDt
- Types: date
- Occurrences: 1000
----------------
#### createdName
- Types: null, string
- Occurrences: 1000
----------------
#### createdPost
- Types: string
- Occurrences: 1000
----------------
#### createdSection
- Types: null, string
- Occurrences: 1000
----------------
#### lastModifiedDt
- Types: date
- Occurrences: 1000
----------------
#### lastModifiedName
- Types: null, string
- Occurrences: 1000
----------------
#### lastModifiedPost
- Types: string
- Occurrences: 1000
----------------
#### lastModifiedSection
- Types: string, null
- Occurrences: 1000
----------------
#### sysFileRefId
- Types: string
- Occurrences: 1000
----------------

## 5. Physical Data Design Considerations

Based on the database analysis and the application's requirements, the following physical data design considerations are recommended:

*   **Indexing:** Implement indexes on frequently queried fields, especially `ApplicationNo`, `NameOfSchoolCN`, `NameOfSchoolEN`, `assignedBS`, `assignedGR`, `sysFileRefId`, `adrBlkId`, and `userId`. This will improve query performance.
*   **Data Types:** Ensure that the data types used in the database schema match the data types used in the application code. This will prevent data type conversion errors.
*   **Data Validation:** Implement data validation rules to ensure data quality. This can be done using Mongoose schema validation or custom validation functions.
*   **Data Partitioning:** Consider data partitioning for large collections like `sysfilerefs` and `adrblkfilerefs` to improve query performance and manageability.
*   **Archiving:** Implement a data archiving strategy to move old data to a separate storage location. This will reduce the size of the active database and improve query performance.
*   **Security:** Implement appropriate security measures to protect sensitive data. This includes encrypting sensitive data, restricting access to the database, and regularly backing up the database.

## 6. Mapping Logical to Physical Data Model

The following tables document how the Logical Data Model (LDM) can be mapped onto the physical data design.

> LSCP Frontend

| Table ID | LSCP Name             | LSCP Entity Description                                 | Key Nature | Key Data Item                | Physical Table Name |
| -------- | --------------------- | ------------------------------------------------------- | ---------- | ---------------------------- | ------------------- |
| T-S-01   | ApplicationCases      | Table to store all the application number               | PK         | Id                           | ApplicationCase     |
|          |                       |                                                         |            | ApplicationNo                |                     |
| T-S-02   | SchoolApp\_Infos      | Table to store the latest update of the submitted application data as 1 row | PK         | Id                           | SchoolAppInfo       |
|          |                       |                                                         |            | ApplicationNo                |                     |
| T-S-03   | SchoolApp\_Submissions | Table to store the submission of each application       | PK         | Id                           | SchoolAppSubmission |
|          |                       |                                                         |            | ApplicationNo                |                     |
|          |                       |                                                         |            | SubmissionId                 |                     |
| T-S-04   | ApplicationFiles      | Table to store all the path of applicant upload files   | PK         | Id                           | ApplicationFile     |
|          |                       |                                                         |            | ApplicationNo                |                     |
|          |                       |                                                         |            | SubmissionId                 |                     |
| T-S-05   | LSCPMasterTable       | Table to store meta-data or parameter data for frontend | PK         | Id                           | ScsMasterTable      |
|          |                       |                                                         |            | Code                         |                     |
|          |                       |                                                         |            | Type + Code                  |                     |
| T-S-06   | GenOtp                | Table to store generated OTP code and the usage status  | PK         | Id                           | GenOtp              |
|          |                       |                                                         |            | ApplicationNo + userId + Otp |                     |
| T-S-07   | AdrBlk                | Table to store addresses that import from BCIS          | PK         | ADR\_BLK\_ID               | AdrBlk              |
| T-S-08   | SYS\_META\_DATA       | Table to store meta data that import from BCIS          | PK         | SYS\_META\_DATA\_ID         | Sys\_Meta\_Data      |
|          |                       |                                                         |            | REC\_TYPE                     |                     |
|          |                       |                                                         |            | CODE                         |                     |
| T-S-09   | Aprse                 | Table to store AP / RSE information that import from MWMS 2.0 | PK         | Id                           | ApRse               |
|          |                       |                                                         |            | Name + RegistrationNumber    |                     |

> LSCP Backend

| Table ID | LSCP Name             | LSCP Entity Description                                 | Key Nature | Key Data Item    | Physical Table Name (MongoDB) |
| -------- | --------------------- | ------------------------------------------------------- | ---------- | ---------------------------- | ----------------------------- |
| T-S-01   | ApplicationCases      | Table to store all the application number               | PK         | Id                           | cases                         |
|          |                       |                                                         |            | ApplicationNo                |                               |
| T-S-02   | SchoolApp\_Infos      | Table to store the latest update of the submitted application data as 1 row | PK         | Id                           | applications                    |
|          |                       |                                                         |            | ApplicationNo                |                               |
| T-S-03   | SchoolApp\_Submissions | Table to store the submission of each application       | PK         | Id                           | submissions                    |
|          |                       |                                                         |            | ApplicationNo                |                               |
|          |                       |                                                         |            | SubmissionId                 |                               |
| T-S-04   | ApplicationFiles      | Table to store all the path of applicant upload files   | PK         | Id                           | attachments                    |
|          |                       |                                                         |            | ApplicationNo                |                               |
|          |                       |                                                         |            | SubmissionId                 |                               |
| T-S-05   | LSCPMasterTable       | Table to store meta-data or parameter data for frontend | PK         | Id                           | N/A (Configuration Files)     |
|          |                       |                                                         |            | Code                         |                               |
|          |                       |                                                         |            | Type + Code                  |                               |
| T-S-06   | SYS\_META\_DATA       | Table to store meta data that import from BCIS          | PK         | SYS\_META\_DATA\_ID         | N/A (Imported Data)           |
|          |                       |                                                         |            | REC\_TYPE                     |                               |
|          |                       |                                                         |            | CODE                         |                               |
| T-S-07   | SYS\_META\_DATA       | Table to store meta data that import from BCIS          | PK         | SYS\_META\_DATA\_ID         | N/A (Imported Data)           |
|          |                       |                                                         |            | REC\_TYPE                     |                               |
|          |                       |                                                         |            | CODE                         |                               |

## 7. Codebase Overview

The codebase consists of three main parts:

*   **bd-scs-backend-backend-main:** This is the backend application built with Node.js and Express. It handles API requests, database interactions, and business logic.
*   **bd-scs-backend-web-main:** This is the web frontend built with React. It provides the user interface for the LSCP.
*   **bd-scs-nodejs-frontend-main:** This appears to be a legacy Node.js frontend, likely being phased out in favor of the React frontend.

The backend models define the structure of the data stored in the MongoDB database. The routes define the API endpoints for accessing and manipulating the data. The scripts directory contains various scripts for importing data, setting up the database, and syncing data between the frontend and backend.

The codebase uses a combination of MongoDB and Microsoft SQL Server 2019. MongoDB is used for storing application data, while Microsoft SQL Server 2019 is used for storing data imported from BCIS and MWMS 2.0.

\*\*\* End of document\*\*\*